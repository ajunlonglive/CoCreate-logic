!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?exports.CoCreate=e():(t.CoCreate=t.CoCreate||{},t.CoCreate.logic=e())}(this,(function(){return(()=>{var t={515:(t,e,n)=>{"use strict";n.r(e),n.d(e,{default:()=>i});const a={attribute:"data-actions",actions:{},selectedStage:[],stageIndex:0,selectedElement:null,completedEventName:"completedEvent",__init:function(){this.actionButtonEvent()},actionButtonEvent:function(){const t=this;document.addEventListener("click",(function(e){let n=e.target;if(n.getAttribute("data-actions")||(n=e.target.closest("[data-actions]")),!n)return;e.preventDefault();let a=(n.getAttribute(t.attribute)||"").replace(/\s/g,"").split(",");0!=a.length&&(t.stageIndex=0,t.selectedStage=a,t.selectedElement=n,t.__runActionFunc())}))},init:function({action:t,callback:e,endEvent:n}){this.registerEvent(t,e,null,n)},registerEvent:function(t,e,n,a){if(this.actions[t])return;this.actions[t]={key:t,runFunc:e,instance:n||window,endEvent:a};for(let e in this.actions)if(e!=t&&this.actions[e].endEvent===a)return;const i=this;document.addEventListener(a,(function(t){i.__nextAction(a,t.detail)}))},__runActionFunc:function(t){if(this.stageIndex>=this.selectedStage.length)return void(this.stageIndex==this.selectedStage.length&&this.__runAtag(this.selectedElement));const e=this.selectedStage[this.stageIndex],n=this.actions[e];if(n)n.runFunc?n.runFunc.call(null,this.selectedElement,t):this.__nextAction(n.endEvent,{});else{"next"===this.__runSpecialAction(e,t)&&this.__moveNextAction()}},__nextAction:function(t,e){const n=this.selectedStage[this.stageIndex];n&&t===this.actions[n].endEvent&&this.__moveNextAction(e)},__runAtag:function(t){t.querySelector("a")},__runSpecialAction:function(t,e){let n=/(\w+)\{([a-zA-Z0-9_ \-#$.]+)\}/gm.exec(t);if(!n||n.length<3)return"next";let a=n[1],i=n[2].trim();if(!i)return"next";const o=this;switch(a){case"event":document.addEventListener(i,(t=>{o.__moveNextAction(t)}),{once:!0});break;case"timeout":parseInt(i)>0&&setTimeout((function(){o.__moveNextAction(e)}),parseInt(i));break;case"action":let t=document.querySelector(i);t&&t.click();break;default:return"next"}},__moveNextAction:function(t){this.stageIndex++,this.__runActionFunc(t)}};a.__init();const i=a},375:function(t,e,n){var a,i;"undefined"!=typeof self&&self,a=[n(446),n(965)],void 0===(i=function(t,e){return function(t,e,n){return{socket:null,setSocket:function(t){this.socket=t},readDocumentList:async function(t){if(!t)return!1;let n=e.getCommonParams();if(!t.collection)return!1;n={...n,...t},e.generateSocketClient(t.namespace,t.room);const a=this.socket.send("readDocumentList",n);try{return await this.socket.listenAsync(a)}catch(t){return null}},createDocument:async function(n){if(null===n)return!1;let a=e.getCommonParamsExtend(n),i={...n,...a},o=n.data||{};o.organization_id||(o.organization_id=t.config.organization_Id),n.data&&(o={...o,...n.data}),i.data=o;const r=e.generateSocketClient(n.namespace,n.room);let s=this.socket.send("createDocument",i,r);try{return await this.socket.listenAsync(s)}catch(t){return null}},updateDocument:async function(t){if(!t)return!1;if(t.document_id&&!n.checkDocumentId(t.document_id))return!1;let a=e.getCommonParamsExtend(t),i={...t,...a};if("object"==typeof t.data&&(i.set=t.data),Array.isArray(t.delete_fields)&&(i.unset=t.delete_fields),!i.set&&!i.unset)return!1;!1===t.broadcast&&(i.broadcast=!1),void 0===t.broadcast_sender&&(i.broadcast_sender=!0);const o=e.generateSocketClient(t.namespace,t.room);let r=this.socket.send("updateDocument",i,o);try{return await this.socket.listenAsync(r)}catch(t){return null}},readDocument:async function(t){if(null===t)return null;if(!t||!n.checkDocumentId(t.document_id))return null;let a=e.getCommonParamsExtend(t),i={...t,...a},o=this.socket.send("readDocument",i);try{return e.generateSocketClient(t.namespace,t.room),await this.socket.listenAsync(o)}catch(t){return null}},deleteDocument:async function(t){if(!t||!n.checkDocumentId(t.document_id))return null;let a=e.getCommonParamsExtend(t),i={...t,...a};const o=e.generateSocketClient(t.namespace,t.room);let r=this.socket.send("deleteDocument",i,o);try{return await this.socket.listenAsync(r)}catch(t){return null}},exportCollection:function(t){if(null===t)return;let n=e.getCommonParamsExtend(t);n.collection=t.collection,n.export_type=t.export_type,n.metadata=t.metadata,this.socket.send("exportDB",n)},importCollection:function(n){const{file:a}=n;if(null===n||!(a instanceof t.File))return;const i=a.name.split(".").pop();if(!["json","csv"].some((t=>t===i)))return;let o=e.getCommonParamsExtend(n);o.collection=n.collection,o.import_type=i,this.socket.send("importDB",o),this.socket.sendFile(a)},listen:function(t,e){this.socket.listen(t,e)},listenAsync:function(t){return this.socket.listenAsync(t)},createSocket:function(t,e){e?(this.socket.create({namespace:e,room:null,host:t}),this.socket.setGlobalScope(e)):this.socket.create({namespace:null,room:null,host:t})},read:async function(t,e){const{collection:a,document_id:i,name:o,namespace:r,room:s,is_read:c}=n.getAttr(t);if(!n.checkAttrValue(i))return!1!==e&&(e=!0),n.isJsonString(a)||n.isJsonString(i)?null:i&&a&&c?await this.readDocument({namespace:r,room:s,collection:a,document_id:i,name:o,is_flat:e}):null},save:async function(t){if(t)for(let e=0;e<t.length;e++)await this.saveElement(t[e])},saveElement:async function({element:e,value:a,is_flat:i}){if(!e||null===a)return;const{collection:o,document_id:r,name:s,namespace:c,room:l,broadcast:u,broadcast_sender:d,is_save:f}=n.getAttr(e);if(f&&o&&s)if(n.isCRDT(e)&&t.CoCreate.crdt)t.CoCreate.crdt.replaceText({collection:o,name:s,document_id:r,name:s,value:a});else{let t=await this.updateDocument({namespace:c,room:l,collection:o,document_id:r,upsert:!0,broadcast:u,broadcast_sender:d,is_flat:!1!==i,data:{[s]:a}});t.document_id&&r!==t.document_id&&await this.setDocumentId({element:e,docuement_id:t.document_id})}},setDocumentId:async function({element:t,form:e,document_id:n}){!e&&t&&(e=t.closest("form")),e?await CoCreate.form.setDocumentId(e):t&&t.setAttribute("data-document_id",n)},...n}}(window,t,e)}.apply(e,a))||(t.exports=i)},611:function(t,e,n){var a,i;"undefined"!=typeof self&&self,a=[n(585),n(375)],void 0===(i=function(t,e){return function(t,e,n){if(t){let t=window.CoCreateCrudSocket;t||(t=new e("ws"),window.CoCreateCrudSocket=t),n.setSocket(t),n.createSocket(window.config.host?window.config.host:window.location.hostname,window.config.organization_Id)}return n}(!0,t,e)}.apply(e,a))||(t.exports=i)},965:function(t,e){var n;"undefined"!=typeof self&&self,void 0===(n=function(){return function(){function t(e,n){e=e||{};for(let a of Object.keys(n))n[a]instanceof Object&&Object.assign(n[a],t(e[a],n[a]));return Object.assign(e||{},n),e}function e(t,e){if(!e)return t;let n=e.split("."),a=t;for(var i=n.length-1;i>=0;i--)a={[n[i]]:a};return a}function n(t,e){try{let n=/([\w\W]+)\[(\d+)\]/gm.exec(t);if(n&&3==n.length){let a=n[1],i=parseInt(n[2]);e[a]&&Array.isArray(e[a])||(e[a]=[]),e[a][i]=e[t],delete e[t],t=a}}catch{}return t}function a(t,e){try{if(!t||!e)return null;if(e[t])return e[t];let a=t.split("."),i={...e};for(var n=0;n<a.length&&i;n++)i=i[a[n]];return i}catch{return null}}function i(t){return!!t&&t.constructor===Object}function o(t){return!!t&&t.constructor===Array}function r(a){let i=Object.keys(a),o={};return i.forEach((i=>{if((i=n(i,a)).split(".").length>1){let n=e(a[i],i);delete a[i],o=t(o,n)}else o[i]=a[i]})),o}function s(t){let e=Object.keys(t),n={};return e.forEach((e=>{let a=t[e];if(i(t[e])){let a=s(t[e]);Object.keys(a).forEach((t=>{let i=a[t];n[t=e+"."+t]=i}))}else o(a)?a.forEach(((t,a)=>{n[`${e}[${a}]`]=t})):n[e]=t[e]})),n}function c(t){if(!t)return;let e=t.getAttribute("data-collection"),n=t.getAttribute("data-document_id"),a=t.getAttribute("name"),i=t.getAttribute("data-room");return{collection:e,document_id:n,name:a,is_realtime:_(t),is_save:u(t),is_read:l(t),is_update:d(t),is_listen:h(t),broadcast:f(t),broadcast_sender:m(t),room:i}}const l=t=>p(t,"data-read_value"),u=t=>p(t,"data-save_value"),d=t=>p(t,"data-update_value"),f=t=>p(t,"data-broadcast"),m=t=>p(t,"data-broadcast_sender"),h=t=>p(t,"data-listen"),_=t=>p(t,"data-realtime");function p(t,e){return!!t&&"false"!==t.getAttribute(e)}function g(t){return!!t&&!/{{\s*([\w\W]+)\s*}}/g.test(t)&&"null"!==t.toLowerCase()}function b(t){try{let e=JSON.parse(t);return"object"==typeof e&&null!=e}catch(t){return!1}}function y(t){const{collection:e,document_id:n,name:a}=c(t);return!(b(e)||b(a)||!("INPUT"===t.tagName&&["text","email","tel","url"].includes(t.type)||"TEXTAREA"===t.tagName)||!a||!_(t)||"true"===t.getAttribute("data-unique")||"password"===t.type||!l(t))}function A(t){try{return!!t&&"null"!==t.toLowerCase()}catch(t){return!1}}function b(t){try{let e=JSON.parse(t);return"object"==typeof e&&null!=e}catch(t){return!1}}return{decodeObject:r,encodeObject:s,getAttr:c,isRealtimeAttr:_,isReadAttr:l,isSaveAttr:u,isUpdateAttr:d,isFlatAttr:t=>p(t,"data-flat"),checkAttrValue:g,isCRDT:y,checkDocumentId:A,getValueByPath:a,isJsonString:b}}()}.apply(e,[]))||(t.exports=n)},366:(t,e,n)=>{"use strict";function a(t){this.callbackMap=new Map,this.callbackMap.set("ALL",{attributes:[],addedNodes:[],removedNodes:[],characterData:[],childList:[]});let[e,n]=this.runCallbackGen("attributes");this.runCallbackAtt=e,this.runCallbackAttAll=n,[e,n]=this.runCallbackGen("characterData"),this.runCallbackChar=e,this.runCallbackCharAll=n,this.runCallbackAdd=this.runCallbackExGen("addedNodes","addedNodes"),this.runCallbackRemove=this.runCallbackExGen("removedNodes","removedNodes");new MutationObserver((t=>this._callback.call(this,t))).observe(t,{subtree:!0,childList:!0,attributes:!0,attributeOldValue:!0,characterData:!0,characterDataOldValue:!0})}n.r(e),n.d(e,{default:()=>o}),window.counter=0;const i=["addedNodes","removedNodes","attributes","characterData","childList"];a.prototype.init=function({observe:t=["addedNodes","attributes"],attributeFilter:e,callback:n}){if(!t||!t.every((t=>i.includes(t))))throw"please enter a valid observe";if(this.observe=t,this.callback=n,e&&e.length)for(let t of e)this._register(t.toLowerCase());else this._register("ALL")},a.prototype._register=function(t){for(let e of this.observe)"childList"!==e?this.callbackMap.has(t)?this.callbackMap.get(t)[e]?this.callbackMap.get(t)[e].push(this.callback):this.callbackMap.get(t)[e]=[this.callback]:this.callbackMap.set(t,{[e]:[this.callback]}):this.callbackMap.get("ALL").childList&&this.callbackMap.get("ALL").childList.push(this.callback)},a.prototype.uninit=function(t){for(let[e,n]of this.callbackMap.entries())n.attributes&&(n.attributes=n.attributes.filter((e=>e!==t))),n.characterData&&(n.characterData=n.characterData.filter((e=>e!==t))),n.addedNodes&&(n.addedNodes=n.addedNodes.filter((e=>e!==t))),n.removedNodes&&(n.removedNodes=n.removedNodes.filter((e=>e!==t))),n.childList&&(n.childList=n.childList.filter((e=>e!==t))),this.callbackMap.set(e,{attributes:n.attributes,characterData:n.characterData,addedNodes:n.addedNodes,removedNodes:n.removedNodes,childList:n.childList})},a.prototype._callback=function(t){for(let e of t)switch(window.counter++,e.type){case"attributes":this._attributeCallback(e);break;case"characterData":this._characterDataCallback(e);break;case"childList":this._childListCallback(e)}},a.prototype.runCallbackGen=function(t){return[function(e,n){let a=this.callbackMap.get(n);if(a&&a[t])for(let n of a[t])n(e)},function(e){for(let n of this.callbackMap.get("ALL")[t])n(e)}]},a.prototype._attributeCallback=function(t){if(!t.target.hasAttributes(t.attributeName))return;t.target.getAttribute(t.attributeName)!==t.oldValue&&(this.runCallbackAtt(t,t.attributeName),this.runCallbackAttAll(t))},a.prototype._characterDataCallback=function(t){if(t.target.data===t.oldValue)return;this.runCallbackCharAll(t);let e=t.target.parentElement;for(let n of e.attributes)this.runCallbackChar(t,n.name)},a.prototype.runCallbackExGen=function(t,e){return function n(a){for(let i of a[e]){if(i.tagName)for(let e of i.attributes){let n=this.callbackMap.get(e.name);if(n&&n[t])for(let e of n[t])e({type:a.type,target:i,[t]:!0})}i.children&&n.call(this,{[e]:i.children})}for(let n of this.callbackMap.get("ALL")[t])for(let i of a[e])i.tagName&&n({type:a.type,target:i,[t]:!0})}},a.prototype._childList=function(t){this.callbackMap.get("ALL").childList.forEach((e=>{e(t)}))},a.prototype._childListCallback=function(t){this._childList(t),this.runCallbackAdd(t),this.runCallbackRemove(t)},a.prototype.setInitialized=function(t,e){t["co_initialized_"+(e=e||"")]=!0},a.prototype.getInitialized=function(t,e){return!!t["co_initialized_"+(e=e||"")]};const o=new a(document.body)},446:function(t,e){var n;"undefined"!=typeof self&&self,void 0===(n=function(){return function(t){function e(){let e={};return t&&t.config&&(e=t.config),{apiKey:e.apiKey,organization_id:e.organization_Id}}function n(e){let n={};return t&&t.config&&(n=t.config),{apiKey:e.apiKey||n.apiKey,organization_id:e.organization_id||n.organization_Id}}function a(e,n){let a={};t&&t.config&&(a=t.config);let i=e||a.organization_Id,o=n||"";return o?`${i}/${o}`:i}return{getCommonParams:e,getCommonParamsExtend:n,generateSocketClient:a}}(window)}.apply(e,[]))||(t.exports=n)},585:function(t,e,n){var a,i;"undefined"!=typeof self&&self,a=[n(446),n(212)],void 0===(i=function(t,e){return function(t,e,n,a,i){class o{constructor(t="crud"){this.prefix=t||"crud",this.sockets=new Map,this.listeners=new Map,this.messageQueue=new Map,this.saveFileName="",this.globalScope=""}setGlobalScope(t){this.globalScope=`${this.prefix}/${t}`}getGlobalScope(){return this.globalScope}create(t){const{namespace:i,room:o}=t,r=this.getKey(i,o);let s,c=this;if(i&&this.setGlobalScope(i),this.sockets.get(r))return void(s=this.sockets.get(r));let l=e.location.protocol;"about:"===e.location.protocol&&(l=e.parent.location.protocol,t.host||(t.host=e.parent.location.host));let u="http:"===l?"ws":"wss";const d=t.port?t.port:8088;let f=`${u}://${e.location.host}:${d}/${r}`;t.host&&(f=t.host.includes("://")?`${t.host}/${r}`:t.host.includes(":")?`${u}://${t.host}/${r}`:`${u}://${t.host}:${d}/${r}`);try{let t=null;e.localStorage&&(t=e.localStorage.getItem("token")),s=new n(f,t),s.cocreate_connected=!1,this.sockets.set(r,s)}catch(t){return}s.onopen=function(t){s.cocreate_connected||(s.cocreate_connected=!0),(c.messageQueue.get(r)||[]).forEach((t=>s.send(JSON.stringify(t)))),c.messageQueue.set(r,[])},s.onclose=function(e){switch(e.code){case 1e3:break;default:c.destroy(s,r),c.reconnect(s,t)}},s.onerror=function(e){c.destroy(s,r),c.reconnect(s,t)},s.onmessage=function(t){try{if(e.Blob&&t.data instanceof a)return void c.saveFile(t.data);let n=JSON.parse(t.data);if(n.data&&(n.data.uid&&c.__fireEvent(n.data.uid,n.data),n.data.event))return void c.__fireEvent(n.data.event,n.data);n.action;const i=c.listeners.get(n.action);if(!i)return;i.forEach((t=>{t(n.data,r)}))}catch(t){}}}__fireEvent(t,n){if(e.CustomEvent){var a=new e.CustomEvent(t,{detail:n});e.document.dispatchEvent(a)}else process.emit(t,n)}send(t,e,n){const a=i.generate(),o={action:t,data:{...e,uid:a}},r=this.getKeyByRoom(n),s=this.getByRoom(n);return s&&s.cocreate_connected?s.send(JSON.stringify(o)):this.messageQueue.get(r)?this.messageQueue.get(r).push(o):this.messageQueue.set(r,[o]),a}sendFile(t,e){const n=this.getByRoom(e);n&&n.send(t)}listen(t,e){this.listeners.get(t)?this.listeners.get(t).push(e):this.listeners.set(t,[e])}reconnect(t,e){let n=this;setTimeout((function(){n.create(e)}),1e3)}destroy(t,e){t&&(t.onerror=t.onopen=t.onclose=null,t.close(),t=null),this.sockets.get(e)&&this.sockets.delete(e)}destroyByKey(t){let e=this.sockets.get(t);e&&this.destroy(e,t)}getKey(t,e){let n=`${this.prefix}`;return t&&""!=t&&(n+=e&&""!=e?`/${t}/${e}`:`/${t}`),n}getByRoom(t){let e=this.getKeyByRoom(t);return this.sockets.get(e)}getKeyByRoom(t){let e=this.globalScope;return t&&(e=`${this.prefix}/${t}`),e}saveFile(t){if(e.document){const a=this.saveFileName||"downloadFile";var n=e.document.createElement("a");e.document.body.appendChild(n),n.style="display: none";let i=window.URL.createObjectURL(t);n.href=i,n.download=a,n.click(),e.URL.revokeObjectURL(i),this.saveFileName=""}}listenAsync(t){return new Promise(((n,a)=>{let i=setTimeout((()=>{clearTimeout(i),n(null)}),5e3);e.document?e.document.addEventListener(t,(function(t){n(t.detail)}),{once:!0}):process.once(t,(t=>{n(t)}))}))}}return o}(0,window,WebSocket,Blob,e)}.apply(e,a))||(t.exports=i)},727:(t,e,n)=>{"use strict";function a(t,e,n){if(e){if(t.classList.contains(e))return t;let n=t.parentNode;for(;null!=n&&n.classList;){if(n.classList.contains(e))return n;n=n.parentNode}}else if(n){if(n.every((e=>t.attributes.hasOwnProperty(e))))return t;let e=t.parentNode;for(;null!=e&&e.attributes;){if(n.every((t=>e.attributes.hasOwnProperty(t))))return e;e=e.parentNode}}return!1}function i(t){try{let e=JSON.parse(t);return"object"==typeof e&&null!=e}catch(t){return!1}}function o(t){return t.getAttributeNames().reduce(((e,n)=>(e[n]=t.getAttribute(n),e)),{})}function r(t){return!!t&&!/{{\s*([\w\W]+)\s*}}/g.test(t)}function s(t,e){try{if(void 0===t)return!1;let n=e.split("."),a=n.shift();return n.length>0?this.__getValueFromJonDeep(t[a],n.join(".")):t[a]}catch(t){return!1}}function c(t){let e=[{document,window}];for(let t of document.querySelectorAll("iframe")){let n=t.contentDocument||t.contentWindow.document,a=t.contentWindow;e.push({document:n,window:a,frameElement:t})}let n=new Set;for(let a of e){let e=t(a);e&&"function"==typeof e[Symbol.iterator]?e.forEach((t=>n.add(t))):e&&n.add(e)}return Array.from(n)}function l(t){let e=[];do{if(!t||!t.tagName)return!1;let n=t.tagName.toLowerCase();if(t.id&&"BODY"!==t.tagName&&(n+="#"+t.id),t.classList.length&&"BODY"!==t.tagName&&t.classList.forEach((t=>{-1===t.indexOf(":")&&(n+="."+t)})),"BODY"!==t.tagName&&t.parentNode){let e=Array.prototype.indexOf.call(t.parentNode.children,t);n+=`:nth-child(${e+1})`}e.unshift(n),t=t.parentNode}while("HTML"!==t.tagName);return e.join(" > ")}function u(){let t=window;for(;t!==window.parent;)t=window.parent;return t}function d(t,e){let n;return c((t=>{t.document.contains(e)&&(n=t.frameElement)})),n}function f(t){let e=u;return t.forEach((t=>{e&&(e=e.querySelector(t))})),e}function*m(t,e){for(let n of t)n.selector&&e.matches(n.selector)&&(yield n)}function h(t,e,n,a){for(let i of m(a||window.elementConfig,t)){if(!0===i[e])return n(t,i);if(!1===i[e])return!1;if(void 0===i[e])continue;if(b(i[e]))return n(t,i,!0)}return!1}function _(t){let e=(new DOMParser).parseFromString(t,"text/html");return e.head.children[0]?e.head.children[0]:e.body.children[0]}function p(t,e){return t.split(e).map((t=>t.trim()))}function g(t,e){return t.map((t=>t.trim())).join(e)}function b(t){try{document.createDocumentFragment().querySelector(t)}catch(t){return!1}return!0}function y(t,e){let n=[],a=(window,d(0,t)),i=l(a);return i&&n.unshift(i),e?{path:n,document:a||document}:n}function A(t="all"){if(!["all","error","warn","log","off"].includes(t))throw new Error("level must be one of all, error, warn, log or off");return{error:function(e){["all","error"].includes(t)},warn:function(e){["all","error","warn"].includes(t)},log:function(){["all","error","warn","log"].includes(t)}}}async function v(t){if("loading"===t.contentDocument.readyState)try{await new Promise(((e,n)=>{t.contentWindow.addEventListener("load",(t=>e()))}))}catch(t){}}function w(t,e){let n=e.split(";"),a=t;for(let t=0;t<n.length-1;t++)if(a=a.querySelector(n[t]),!a)return[];return[this,[n.length-1]]}function k(t){let[e,n]=w(this,t);return e?e.contentWindow.document.querySelector(n):null}function E(t){let[e,n]=w(this,t);return e?e.contentWindow.document.querySelectorAll(n):[]}n.r(e),n.d(e,{getParentFromElement:()=>a,isJsonString:()=>i,getAttributes:()=>o,checkAttrValue:()=>r,getValueFromJonDeep:()=>s,allFrame:()=>c,cssPath:()=>l,getTopMostWindow:()=>u,findIframeFromElement:()=>d,getIframeFromPath:()=>f,configMatch:()=>m,configExecuter:()=>h,parseTextToHtml:()=>_,splitBydelimiter:()=>p,joinBydelimiter:()=>g,isValidSelector:()=>b,getElementPath:()=>y,logger:()=>A,waitForLoad:()=>v,getComplexSelector:()=>w,frameQuerySelector:()=>k,frameQuerySelectorAll:()=>E,default:()=>x});const x={getElementPath:y,isValidSelector:b,joinBydelimiter:g,splitBydelimiter:p,parseTextToHtml:_,configExecuter:h,configMatch:m,getIframeFromPath:f,findIframeFromElement:d,getTopMostWindow:u,cssPath:l,allFrame:c,checkAttrValue:r,getAttributes:o,isJsonString:i,getParentFromElement:a,logger:A}},212:function(t,e){var n;"undefined"!=typeof self&&self,void 0===(n=function(){return function(t){const e={attribute:"data-uuid",init:function(e){if(!t.document)return;const n=e||t.document;if(!n.querySelectorAll)return;let a=n.querySelectorAll(`[${this.attribute}]`);const i=this;a.forEach((t=>{const e=parseInt(t.getAttribute(i.attribute))||36,n=i.generate(e);"INPUT"===t.tagName||"TEXTAREA"===t.tagName?t.value=n:t.innerHTML=n}))},generate:function(e=36){let n=(new Date).getTime(),a=t.performance&&t.performance.now&&1e3*t.performance.now()||0,i="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx";if(e<=i.length)i=i.substr(0,e);else{let t=e-i.length,n="-xxxyyxxx",a=Math.floor(t/n.length);for(let t=0;t<a;t++)i+=n;a=t-a*n.length,i+=n.substr(0,a)}return i.replace(/[xy]/g,(function(t){var e=16*Math.random();return n>0?(e=(n+e)%16|0,n=Math.floor(n/16)):(e=(a+e)%16|0,a=Math.floor(a/16)),("x"==t?e:7&e|8).toString(16)}))}};return e.init(),e}(window)}.apply(e,[]))||(t.exports=n)},586:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var a=o(n(366)),i=(o(n(727)),o(n(611)));function o(t){return t&&t.__esModule?t:{default:t}}const r={mainInfo:{},init:function(){const t=this;i.default.listen("updateDocument",(function(e){t.render(e)})),i.default.listen("readDocument",(function(e){t.render(e)})),i.default.listen("connect",(function(e){t.__getRequest()}))},initElement:function(t){const e=this.__getRequest(t);e&&e.forEach((t=>{i.default.readDocument({collection:t.collection,document_id:t.document_id})}))},render:function(t){const e=t.collection,n=t.document_id;for(let a in t.data){const i=this.__makeKey(e,n,a),o=t.data[a];this.mainInfo[i]&&this.mainInfo[i].forEach((t=>{t.el.setAttribute(t.attr,o),t.el.dispatchEvent(new CustomEvent("CoCreateAttribute-run",{eventType:"rendered",item:t.el}))}))}},setValue:function(t,e){},__getRequest:function(t){let e=t||document,n=e.querySelectorAll("[fetch-for]"),a=this,i=[];return 0===n.length&&e!=document&&e.hasAttributes("fetch-for")&&(n=[e]),n.forEach((t=>{const e=t.getAttribute("data-collection"),n=t.getAttribute("data-document_id"),o=t.getAttribute("name"),r=t.getAttribute("value"),s=t.attributes;for(let c=0;c<s.length;c++){let l=a.__jsonParse(s[c].value);if(l){let u=l.collection||e,d=l.document_id||n,f=l.name||o,m=l.value||r;if(l["data-pass_id"]){let t=a.__checkPassId(l["data-pass_id"]);t?(u=t.collection,d=t.document_id,m=t.value):(u=null,d=null,m=null)}const h=a.__makeKey(u,d,f);u&&d&&f&&(a.mainInfo[h]||(a.mainInfo[h]=[]),a.mainInfo[h].push({el:t,attr:s[c].name}),i.some((t=>t.collection===u&&t.document_id===d))||i.push({collection:u,document_id:d}))}}})),i},__jsonParse:function(t){try{let e=JSON.parse(t);return"object"==typeof e&&null!=e?e:null}catch(t){return null}},__checkPassId:function(t){var e=localStorage.getItem("dataParams");if(!(e=JSON.parse(e))||0==e.length)return null;for(var n=0;n<e.length;n++)if(e[n].pass_to==t)return{collection:e[n].collection,document_id:e[n].document_id,value:e[n].value};return null},__makeKey:function(t,e,n){return`${t}_${e}_${n}`}};r.init(),a.default.init({name:"CoCreateLogicAttributes",observe:["addedNodes"],attributesFilter:["data-for"],callback:function(t){r.initElement(t.target)}});var s=r;e.default=s}},e={};function n(a){var i=e[a];if(void 0!==i)return i.exports;var o=e[a]={exports:{}};return t[a].call(o.exports,o,o.exports,n),o.exports}n.d=(t,e)=>{for(var a in e)n.o(e,a)&&!n.o(t,a)&&Object.defineProperty(t,a,{enumerable:!0,get:e[a]})},n.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),n.r=t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})};var a={};return(()=>{"use strict";var t=a;t.default=void 0;var e=o(n(366)),i=o(n(515));function o(t){return t&&t.__esModule?t:{default:t}}const r={attributes:o(n(586)).default,init:function(){this.__initKeys(),this.__initPassSessionIds(),this.__initPassParams(),this.__initPassValueParams(),this.__initGetValueInput(),this.initAtagElement()},__initKeys:function(){window.localStorage.getItem("apiKey")&&(config.apiKey=window.localStorage.getItem("apiKey")),window.localStorage.getItem("securityKey")&&(config.securityKey=window.localStorage.getItem("securityKey")),window.localStorage.getItem("organization_id")&&(config.organization_Id=window.localStorage.getItem("organization_id"))},__initPassSessionIds:function(){let t=window.localStorage.getItem("organization_id"),e=window.localStorage.getItem("user_id"),n=window.localStorage.getItem("adminUI_id"),a=window.localStorage.getItem("builderUI_id");this.__initPassItems(t,".sessionOrg_Id",!0),this.__initPassItems(e,".sessionUser_Id"),this.__initPassItems(n,".sessionAdminUI_Id"),this.__initPassItems(a,".sessionBuilderUI_Id")},__initPassItems:function(t,e,n){const a=this;if(t){document.querySelectorAll(e).forEach((e=>{a.__setAttributeValueOfElement(e,"data-document_id",t),a.__setAttributeValueOfElement(e,"data-filter_value",t)}))}},initElement:function(t){const n=this;let a=t||document;if(!a.querySelectorAll)return;let i=a.querySelectorAll("[data-pass_id]");i=Array.from(i),a!=document&&a.hasAttribute("data-pass_id")&&i.push(a);let o=window.localStorage.getItem("dataParams");o=JSON.parse(o),o&&0!=o.length&&i.forEach((t=>{if(e.default.getInitialized(t))return;const a=t.getAttribute("data-pass_id"),i=o.find((t=>t.pass_to==a));if(!i)return;const{collection:r,document_id:s,pass_to:c,prefix:l}=i;e.default.setInitialized(t),"FORM"===t.tagName&&!t.getAttribute("data-colleciton")&&r&&t.setAttribute("data-colleciton",r),n.__setPassAttributes(t,i)}))},initAtagElement:function(){const t=this;document.addEventListener("click",(function(e){const n=e.target.closest("a, button");if(!n)return;if("modal"===n.getAttribute("target")&&n.getAttribute("data-pass_to"))return e.preventDefault(),void t.setLinkProcess(n);const a=n.getAttribute("href");if("modal"!==n.getAttribute("target")){if(n.hasAttribute("data-actions"))return;const i=n.getAttribute("data-pass_to");a?(e.preventDefault(),t.storePassData(n),t.openAnother(n)):(t.storePassData(n),i&&t.__initPassParams(i))}}))},__initPassParams:function(t){var e=window.localStorage.getItem("dataParams");if(!(e=JSON.parse(e))||0==e.length)return;let n=this;e.forEach((function(e){var a=e.collection,i=(e.document_id,e.prefix,e.pass_to);t&&i!=t||(document.querySelectorAll("form").forEach((t=>{var e=t.getAttribute("data-pass_id");e&&e==i&&a&&""!=a&&(t.getAttribute("data-collection")||t.setAttribute("data-collection",a))})),document.querySelectorAll("[data-pass_id]").forEach((t=>{var a=t.getAttribute("data-pass_id");a&&a==i&&n.__setPassAttributes(t,e)})))}))},__initPassValueParams:function(t){var e=window.localStorage.getItem("valueParams");(e=JSON.parse(e))&&0!=e.length&&e.forEach((function(e){var n=e.pass_value_to;(t||document).querySelectorAll("[data-pass_value_id]").forEach((t=>{let a=t.getAttribute("data-pass_value_id");a&&a==n&&(["INPUT","TEXTAREA","SELECT"].includes(t.tagName)?(t.value=e.value,CoCreate.floatingLabel&&CoCreate.floatingLabel.update(t)):t.innerHTML=e.value)}))}))},__getPassAttributes:function(t){return{collection:t.getAttribute("data-pass_collection")||t.getAttribute("data-pass_fetch_collection"),document_id:t.getAttribute("data-pass_document_id"),name:t.getAttribute("data-pass_name"),value:t.getAttribute("data-pass_value"),pass_to:t.getAttribute("data-pass_to"),filter_name:t.getAttribute("data-pass_filter_name"),filter_value:t.getAttribute("data-pass_filter_value"),prefix:t.getAttribute("data-pass_prefix")||""}},__setPassAttributes:function(t,e){const{collection:n,document_id:a,name:i,value:o,pass_to:r,filter_name:s,filter_value:c,prefix:l}=e,u=t.getAttribute("data-pass_id"),d=!!t.hasAttribute("data-pass_refresh");u==r&&(n&&(this.__setAttributeValueOfElement(t,"data-collection",n,d),this.__setAttributeValueOfElement(t,"data-fetch_collection",n,d),this.__setAttributeValueOfElement(t,"data-pass_fetch_collection",n,d),this.__setAttributeValueOfElement(t,"data-pass_collection",n,d)),a&&(this.__setAttributeValueOfElement(t,"data-document_id",a,d),this.__setAttributeValueOfElement(t,"data-fetch_document_id",a,d),this.__setAttributeValueOfElement(t,"data-pass_fetch_document_id",a,d),this.__setAttributeValueOfElement(t,"data-pass_document_id",a,d)),i&&(this.__setAttributeValueOfElement(t,"name",i,d),this.__setAttributeValueOfElement(t,"data-fetch_name",i,d),this.__setAttributeValueOfElement(t,"data-pass_name",i,d)),o&&(this.__setAttributeValueOfElement(t,"value",o,d),this.__setAttributeValueOfElement(t,"data-pass_value",o,d)),l&&(this.__setAttributeValueOfElement(t,"name",l+t.getAttribute("name"),d,!0),this.__setAttributeValueOfElement(t,"data-fetch_name",l+t.getAttribute("data-fetch_name"),d,!0),this.__setAttributeValueOfElement(t,"data-pass_prefix",l,d)),s&&(this.__setAttributeValueOfElement(t,"data-filter_name",s,d),this.__setAttributeValueOfElement(t,"data-pass_filter_name",s,d)),c&&(this.__setAttributeValueOfElement(t,"data-filter_value",c,d),this.__setAttributeValueOfElement(t,"data-pass_filter_value",c,d)))},__setAttributeValueOfElement:function(t,e,n,a,i){if(n){if(t.hasAttribute(e)&&i)return void t.setAttribute(e,n);if(t.hasAttribute(e)&&(!t.getAttribute(e)||a))return void t.setAttribute(e,n)}},storePassData:function(t){let e=[];const n=this;let a=this.__getPassAttributes(t);t.hasAttribute("data-actions")||(a.pass_to&&e.push(a),t.querySelectorAll("[data-pass_to]").forEach((t=>{let a=n.__getPassAttributes(t);a.pass_to&&e.push(a)})),e.length>0&&localStorage.setItem("dataParams",JSON.stringify(e)))},__initGetValueInput:function(){var t=document.querySelectorAll("input, textarea");let e=this;for(var n=0;n<t.length;n++){var a=t[n];a.id&&(a.addEventListener("input",(function(t){e.__setGetValueProcess(this.id,this.value)})),a.addEventListener("updated_by_fetch",(function(t){e.__setGetValueProcess(this.id,this.value)})))}},passProcessAction:function(t){let e=t.closest("form");if(!e)return;let n=e.querySelectorAll("input, textarea, select"),a=[];n.forEach((t=>{const e=t.getAttribute("data-pass_value_to"),n=t.value;e&&a.push({pass_value_to:e,value:n})})),a.length>0&&window.localStorage.setItem("valueParams",JSON.stringify(a)),this.__initPassValueParams(),document.dispatchEvent(new CustomEvent("passValueActionEnd",{detail:{}}))},setDataPassValues:function(t){const e=[];for(let n in t)e.push({pass_value_to:n,value:t[n]});e.length>0&&window.localStorage.setItem("valueParams",JSON.stringify(e))},initDataPassValues:function(){window.localStorage.removeItem("valueParams")},openAnother:function(t){var e=t.getAttribute("href"),n=t.getAttribute("target");"_blank"==n?window.open(e,"_blank"):"_window"==n?window.open(e,"_blank","location=yes,height=570,width=520,scrollbars=yes,status=yes"):window.open(e,"_self")},setLinkProcess:function(t){if(t.hasAttribute("data-actions"))return;const e=t.getAttribute("data-pass_to"),n=t.getAttribute("href");this.storePassData(t),this.checkOpenCocreateModal(t)?void 0!==CoCreate.modal&&CoCreate.modal.open(t):n?this.openAnother(t):e&&this.__initPassParams(e)},checkOpenCocreateModal:function(t){return"modal"===t.getAttribute("target")},__setGetValueProcess:function(t,e){t&&document.querySelectorAll('[data-get_value="'+t+'"]').forEach((t=>{if(void 0!==t.value?t.value=e:void 0!==t.textContent&&(t.textContent=e),CoCreate.floatingLabel&&CoCreate.floatingLabel.update(t),t.dispatchEvent(new Event("input",{bubbles:!0})),t.classList.contains("searchInput")){let e=new KeyboardEvent("keydown",{keyCode:13});t.dispatchEvent(e)}}))}};r.init(),e.default.init({name:"CoCreateAttributes",observe:["addedNodes"],attributesFilter:["data-for"],callback:function(t){let e=t.target;r.attributes.initElement(e)}}),e.default.init({name:"CoCreateLogic",observe:["addedNodes"],attributesFilter:["data-pass_id"],callback:function(t){r.initElement(t.target)}}),i.default.init({action:"passValueAction",endEvent:"passValueActionEnd",callback:(t,e)=>{r.passProcessAction(t)}});var s=r;t.default=s})(),a=a.default})()}));